---
layout: layouts/base.njk
---
<h1 class="visually-hidden">{{ title }}</h1>
{% set statuses = { 'done': '–ì–æ—Ç–æ–≤–æ', 'in_progress': '–ó–∞–≤–µ—Ä—à—ë–Ω', 'invest': '–û—Ç–∫—Ä—ã—Ç –¥–ª—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π' } %}
<nav id="map-drawer" class="filters">
	<fieldset id="status-filters" class="filter-group filter-group--status">
		<legend class="filter-group__title">–°—Ç–∞—Ç—É—Å</legend>
		{% for status, status_name in statuses %}
			<input type="checkbox" id="status-filter-{{ status }}" name="status-filter" value="{{ status }}" checked>
			<label for="status-filter-{{ status }}">{{ status_name }}</label><br>
		{% endfor %}
	</fieldset>
	<fieldset class="filter-group">
		<legend class="filter-group__title">–ì–æ—Ä–æ–¥</legend>
		{% for city in collections.cities %}
			<a class="filter-group__link" href="/cities/{{ city.fileSlug }}">{{ city.data.title }}</a>
		{% endfor %}
	</fieldset>
</nav>
{%- for project in collections.projects %}
	<template class="project-popup" id="project-{{ project.fileSlug }}">
		{% if project.data.cover %}
		<img alt="" class="project-popup__cover" src="{{ project.data.cover }}" 
            width="300"
            height="200"
            decoding="async"
            loading="lazy">
		{% endif %}
		<h2 class="project-popup__title">{{ project.data.title }}</h2>
		<span class="project-popup__status">{{ statuses[project.data.status] }}</span>
		{{ project.content | safe }}
		<a class="project-popup__btn project-popup__btn--{{ project.data.status }}" href="{{ project.data.url }}" target="_blank">
          {{ '–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–±—ä–µ–∫—Ç–∞' if status === 'done' else '–û¬†–ø—Ä–æ–µ–∫—Ç–µ' }}
		</a>
		<a
			class="project-popup__link"
			title="–ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –¥–ª—è –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è"
			href="/projects/{{ project.fileSlug }}"
		>
			üîó
		</a>
	</template>
{%- endfor %}
{{ content | safe }}
<script type="module">
	import {createCityMap} from '{{ "/lib/ymaps.js" | htmlBaseUrl }}'

	createCityMap({
		longitude: '{{ longitude }}',
		latitude: '{{ latitude }}',
		zoom: '{{ zoom }}',
		features: [
			{%- for project in collections.projects %}
				{
					id: '{{ project.fileSlug }}',
					type: 'Feature',
					geometry: {
						type: 'Point',
						coordinates: [{{ project.data.longitude }}, {{ project.data.latitude }}],
					},
					properties: {
						status: '{{ project.data.status }}',
						size: '{{ "normal" if project.data.is_big else "small" }}',
						title: '{{ project.data.title }}',
					},
				},
			{%- endfor %}
		],
	});
</script>